<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>CIV:BOOT</title>
  <style>
    body {
      background-color: black;
      color: #00ff00;
      font-family: 'Courier New', Courier, monospace;
      padding: 15px;
      margin: 0;
      font-size: 1.1rem;
      line-height: 1.4;
    }

    #output {
      white-space: pre-wrap;
      margin-bottom: 20px;
      overflow-wrap: break-word;
    }

    input {
      background-color: black;
      color: #00ff00;
      border: none;
      border-bottom: 1px solid #00ff00;
      font-family: inherit;
      font-size: 1.1rem;
      width: 100%;
      padding: 10px 5px;
      box-sizing: border-box;
    }

    input:focus {
      outline: none;
    }

    .btn-container {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    button {
      background-color: black;
      color: #00ff00;
      border: 1px solid #00ff00;
      font-family: inherit;
      font-size: 1.1rem;
      padding: 8px 16px;
      cursor: pointer;
      flex: 1 0 30%;
    }

    button:hover {
      background-color: #003300;
    }
  </style>
</head>
<body>
  <div id="output"></div>
  <input id="input" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
  <div class="btn-container" id="buttons"></div>

  <script>
    const output = document.getElementById("output");
    const input = document.getElementById("input");
    const buttons = document.getElementById("buttons");

    let state = "booting";
    let civName = "";
    let year = 1;
    let population = 50;
    let food = 100;
    let resources = 100;
    let location = "";

    const asciiLogo = `
  ___  ____  _  _    ____  _____  _____  ____ 
 / __)(_  _)( \\/ )()(  _ \\(  _  )(  _  )(_  _)
( (__  _)(_  \\  /    ) _ < )(_)(  )(_)(   )(  
 \\___)(____)  \\/  ()(____/(_____)(_____) (__) 
`;

    const bootLines = [
      asciiLogo,
      "\n--- CIV:BOOT v1.0 BIOS ---",
      "[BOOT] Initializing core systems...",
      "[OK]   Memory check complete.",
      "[OK]   Kernel loaded.",
      "[OK]   AI Commander Interface online.",
      "[INFO] Civilization Engine ready.",
      "\n> Enter your civilization name:"
    ];

    function typeLines(lines, i = 0) {
      if (i < lines.length) {
        typeText(lines[i] + '\n', () => typeLines(lines, i + 1));
      } else {
        state = "start";
        input.disabled = false;
        input.focus();
      }
    }

    function typeText(text, callback, speed = 20) {
      let i = 0;
      function typer() {
        if (i < text.length) {
          output.innerText += text[i++];
          scrollToBottom();
          setTimeout(typer, speed);
        } else if (callback) {
          callback();
        }
      }
      typer();
    }

    function scrollToBottom() {
      window.scrollTo(0, document.body.scrollHeight);
    }

    function setButtons(options) {
      buttons.innerHTML = "";
      options.forEach(opt => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => handleInput(opt);
        buttons.appendChild(btn);
      });
    }

    function displayStats() {
      typeText(`\n--- YEAR ${year} REPORT ---\nPopulation: ${population}\nFood: ${food}\nResources: ${resources}\n`, () => {
        typeText("\nChoose action: [farm / mine / train]\n");
        setButtons(["farm", "mine", "train"]);
        state = "yearChoice";
      });
    }

    function randomEvent() {
      const events = [
        { text: "A good harvest boosts your food supply.", food: +30 },
        { text: "Bandits raided your village. You lost resources.", resources: -20 },
        { text: "A plague reduced your population.", population: -10 },
        { text: "You discovered a new iron deposit!", resources: +25 },
        { text: "A peaceful year passes.", food: 0, population: 0, resources: 0 }
      ];
      return events[Math.floor(Math.random() * events.length)];
    }

    function nextYear() {
      year++;
      food -= population;
      if (food < 0) {
        population += Math.floor(food / 10);
        food = 0;
      }
      const event = randomEvent();
      population += event.population || 0;
      food += event.food || 0;
      resources += event.resources || 0;
      typeText(`\n\n>>> YEAR ${year} <<<\nEvent: ${event.text}`, () => displayStats());
    }

    function handleInput(val) {
      const value = val.trim().toLowerCase();
      output.innerText += `\n> ${value}`;
      scrollToBottom();

      if (state === "start") {
        civName = value;
        typeText(`\nWelcome, leader of ${civName}.\nChoose your starting location: [plains / mountains / coast]\n`);
        setButtons(["plains", "mountains", "coast"]);
        state = "chooseLocation";

      } else if (state === "chooseLocation") {
        if (["plains", "mountains", "coast"].includes(value)) {
          location = value;
          typeText(`\n${civName} settles near the ${location}.\nYear 1 begins...`, () => {
            displayStats();
          });
        } else {
          typeText(`\nInvalid location. Choose: plains, mountains, or coast.\n`);
        }

      } else if (state === "yearChoice") {
        if (value === "farm") {
          food += 30;
          typeText(`\nYour people plant crops. (+30 food)`, nextYear);
        } else if (value === "mine") {
          resources += 30;
          typeText(`\nYou mine nearby hills. (+30 resources)`, nextYear);
        } else if (value === "train") {
          resources -= 10;
          typeText(`\nYou train a small militia. (-10 resources)`, nextYear);
        } else {
          typeText(`\nInvalid action. Choose: farm, mine, or train.\n`);
        }
      }
    }

    input.addEventListener("keydown", function (e) {
      if (e.key === "Enter" && input.value.trim() !== "") {
        handleInput(input.value);
        input.value = "";
      }
    });

    // Start with boot sequence
    input.disabled = true;
    typeLines(bootLines);
  </script>
</body>
</html>
